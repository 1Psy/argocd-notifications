
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.3">
    
    
      
        <title>v0.x to v1.0 - Argo CD Notifications</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.3b61ea93.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.39b8e14a.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Work+Sans:300,400,400i,700%7C&display=fallback">
        <style>body,input{font-family:"Work Sans",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-105170809-5","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview",document.location.pathname)})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="teal" data-md-color-accent="">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#v0x-to-v10" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="Argo CD Notifications" class="md-header-nav__button md-logo" aria-label="Argo CD Notifications">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Argo CD Notifications
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              v0.x to v1.0
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/argoproj-labs/argocd-notifications/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Argo CD Notifications" class="md-nav__button md-logo" aria-label="Argo CD Notifications">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    Argo CD Notifications
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/argoproj-labs/argocd-notifications/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      



  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../triggers/" class="md-nav__link">
      Triggers
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../subscriptions/" class="md-nav__link">
      Subscriptions
    </a>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
    
    <label class="md-nav__link" for="nav-4">
      Notification Services
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Notification Services" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Notification Services
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../services/overview/" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../services/slack/" class="md-nav__link">
      Slack
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../services/opsgenie/" class="md-nav__link">
      Opsgenie
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../services/grafana/" class="md-nav__link">
      Grafana
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../services/telegram/" class="md-nav__link">
      Telegram
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../services/webhook/" class="md-nav__link">
      Webhook
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../catalog/" class="md-nav__link">
      Triggers and Templates Catalog
    </a>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../troubleshooting/" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" >
    
    <label class="md-nav__link" for="nav-7">
      Bots
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Bots" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon"></span>
        Bots
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../bots/overview/" class="md-nav__link">
      Bot (v0.5)
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../bots/slack-bot/" class="md-nav__link">
      Slack bot (v0.5)
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../bots/opsgenie-bot/" class="md-nav__link">
      Opsgenie bot
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../bots/telegram-bot/" class="md-nav__link">
      Telegram bot
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  <li class="md-nav__item">
    <a href="../../monitoring/" class="md-nav__link">
      Monitoring
    </a>
  </li>

    
      
      
      


  


  
  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9" checked>
    
    <label class="md-nav__link" for="nav-9">
      Upgrading
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Upgrading" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon"></span>
        Upgrading
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        v0.x to v1.0
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      v0.x to v1.0
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#breaking-changes" class="md-nav__link">
    Breaking Changes
  </a>
  
    <nav class="md-nav" aria-label="Breaking Changes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#built-in-triggers-and-templates-are-removed" class="md-nav__link">
    Built-in triggers and templates are removed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#webhook-subscriptions" class="md-nav__link">
    Webhook Subscriptions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upgrading-to-new-settings-and-annotations" class="md-nav__link">
    Upgrading To New Settings and Annotations
  </a>
  
    <nav class="md-nav" aria-label="Upgrading To New Settings and Annotations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#notification-services" class="md-nav__link">
    Notification Services
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-triggers-and-templates" class="md-nav__link">
    Custom Triggers and Templates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger-definition" class="md-nav__link">
    Trigger Definition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recipientsubscription-annotation" class="md-nav__link">
    Recipient/Subscription Annotation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#breaking-changes" class="md-nav__link">
    Breaking Changes
  </a>
  
    <nav class="md-nav" aria-label="Breaking Changes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#built-in-triggers-and-templates-are-removed" class="md-nav__link">
    Built-in triggers and templates are removed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#webhook-subscriptions" class="md-nav__link">
    Webhook Subscriptions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upgrading-to-new-settings-and-annotations" class="md-nav__link">
    Upgrading To New Settings and Annotations
  </a>
  
    <nav class="md-nav" aria-label="Upgrading To New Settings and Annotations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#notification-services" class="md-nav__link">
    Notification Services
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-triggers-and-templates" class="md-nav__link">
    Custom Triggers and Templates
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trigger-definition" class="md-nav__link">
    Trigger Definition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recipientsubscription-annotation" class="md-nav__link">
    Recipient/Subscription Annotation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/argoproj-labs/argocd-notifications/edit/master/docs/upgrading/0.x-1.0.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="v0x-to-v10">v0.x to v1.0<a class="headerlink" href="#v0x-to-v10" title="Permanent link">&para;</a></h1>
<p>The v1.0 release introduces a lot of new features and changes the format of configuration settings to improve usability.
However, most of the pre-v1.0 settings and annotations are still supported. So you can upgrade with a minimal set of manual changes
and migrate to new settings gradually.</p>
<h2 id="breaking-changes">Breaking Changes<a class="headerlink" href="#breaking-changes" title="Permanent link">&para;</a></h2>
<p>This section lists breaking changes that could not be done in a backward compatible way and corresponding upgrade steps:</p>
<h3 id="built-in-triggers-and-templates-are-removed">Built-in triggers and templates are removed<a class="headerlink" href="#built-in-triggers-and-templates-are-removed" title="Permanent link">&para;</a></h3>
<p>Built-in (hard-coded) triggers and template were replaced with <a href="../../catalog/">catalog</a>.</p>
<p><strong>Why was it changed?</strong></p>
<p>The built-in triggers and templates were meant to simplify onboarding. Instead of configuring everything from scratch user
could just use triggers and templates developed by the community. However one set of triggers and templates don't work for everyone.
So instead of baking it into binary triggers and templates now can be distributed as a simple YAML file. All built-in triggers
and templates were moved into <a href="https://raw.githubusercontent.com/argoproj-labs/argocd-notifications/release-v1.0/catalog/install.yaml">catalog/install.yaml</a></p>
<p>After upgrading make sure to either kubectl apply it:</p>
<div class="codehilite"><pre><span></span><code><span class="err">kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj-labs/argocd-notifications/release-v1.0/catalog/install.yaml</span>
</code></pre></div>

<p>or include as a patch into your <code>kustomization.yaml</code> file:</p>
<div class="codehilite"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">kustomize.config.k8s.io/v1beta1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Kustomization</span>

<span class="nt">resources</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">https://github.com/argoproj-labs/argocd-notifications/manifests/bot?ref=release-v1.0</span>

<span class="nt">patchesStrategicMerge</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">https://raw.githubusercontent.com/argoproj-labs/argocd-notifications/release-v1.0/catalog/install.yaml</span>
</code></pre></div>

<h3 id="webhook-subscriptions">Webhook Subscriptions<a class="headerlink" href="#webhook-subscriptions" title="Permanent link">&para;</a></h3>
<p>The webhook recipient annotation value had special format: <code>webhook:&lt;webhook-name&gt;</code> (e.g. <code>on-app-synced.recipients.argocd-notifications.argoproj.io: webhook:github</code>).
In v1.0 the annotation value has to change to just <code>github</code> and <code>webhook:</code> prefix should be removed.</p>
<p><strong>Why was it changed?</strong></p>
<p>Previous way to configure notification services did not allow to give a custom service name, so you could configure only one Slack or email integation.
The webhook was an exception and relied on <code>webhook:&lt;name&gt;</code> format to support multiple webhook types. The v1.0 allows giving a custom name to any service
and exception for webhook no longer required.</p>
<h2 id="upgrading-to-new-settings-and-annotations">Upgrading To New Settings and Annotations<a class="headerlink" href="#upgrading-to-new-settings-and-annotations" title="Permanent link">&para;</a></h2>
<h3 id="notification-services">Notification Services<a class="headerlink" href="#notification-services" title="Permanent link">&para;</a></h3>
<p>The <code>notifiers.yaml</code> key of <code>argocd-notifications-secret</code> is replaced with <code>service.&lt;service-type&gt;(.&lt;service-name&gt;)</code> keys in <code>argocd-notifications-cm</code> ConfigMap.</p>
<p><strong>Why was it changed?</strong></p>
<p>The change allows to provide custom name to any service and enables support for more than one Slack/Email etc integation.</p>
<p><strong>Before</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Secret</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argocd-notifications-secret</span>
<span class="nt">stringData</span><span class="p">:</span>
  <span class="nt">notifiers.yaml</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">email:</span>
      <span class="no">host: smtp.gmail.com</span>
      <span class="no">port: 587</span>
      <span class="no">from: &lt;myemail&gt;@gmail.com</span>
      <span class="no">username: &lt;myemail&gt;@gmail.com</span>
      <span class="no">password: &lt;mypassword&gt;</span>
</code></pre></div>

<p><strong>After</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argocd-notifications-cm</span>
<span class="nt">data</span><span class="p">:</span>
  <span class="nt">service.email</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">host: smtp.gmail.com</span>
    <span class="no">port: 587</span>
    <span class="no">from: &lt;myemail&gt;@gmail.com</span>
    <span class="no">username: $email-username</span>
    <span class="no">password: $email-password</span>
</code></pre></div>

<p>Sensitive values like tokens and password are still stored in <code>argocd-notifications-secret</code> Secret and can be referenced as <code>$&lt;key-name&gt;</code>.</p>
<h3 id="custom-triggers-and-templates">Custom Triggers and Templates<a class="headerlink" href="#custom-triggers-and-templates" title="Permanent link">&para;</a></h3>
<p><strong>Why was it changed?</strong></p>
<p>The change allows to distribute templates and triggers as ConfigMap merge patch and enables templates/triggers catalogs.</p>
<p>The custom triggers and templates are no longer stored in <code>config.yaml</code> format. Instead you can use <code>trigger.&lt;trigger-name&gt;</code> and <code>template.&lt;template-name&gt;</code>
keys.</p>
<p><strong>Before</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argocd-notifications-cm</span>
<span class="nt">data</span><span class="p">:</span>
  <span class="nt">config.yaml</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">triggers:</span>
      <span class="no">- name: on-sync-status-unknown</span>
        <span class="no">condition: app.status.sync.status == &#39;Unknown&#39;</span>
        <span class="no">template: app-sync-status</span>
        <span class="no">enabled: true</span>
    <span class="no">templates:</span>
      <span class="no">- name: app-sync-status</span>
        <span class="no">title: Application {{.app.metadata.name}} sync status is {{.app.status.sync.status}}</span>
        <span class="no">body: |</span>
          <span class="no">Application {{.app.metadata.name}} sync is {{.app.status.sync.status}}.</span>
          <span class="no">Application details: {{.context.argocdUrl}}/applications/{{.app.metadata.name}}.</span>
</code></pre></div>

<p><strong>After</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">argocd-notifications-cm</span>
<span class="nt">data</span><span class="p">:</span>
  <span class="c1"># Triggers define the condition when the notification should be sent and list of templates required to generate the message</span>
  <span class="c1"># Recipients can subscribe to the trigger and specify the required message template and destination notification service.</span>
  <span class="nt">trigger.on-sync-status-unknown</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">- when: app.status.sync.status == &#39;Unknown&#39;</span>
      <span class="no">send: [my-custom-template]</span>
  <span class="c1"># Templates are used to generate the notification template message</span>
  <span class="nt">template.app-sync-status</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">title: Application {{.app.metadata.name}} sync status is {{.app.status.sync.status}}</span>
    <span class="no">body: |</span>
      <span class="no">Application {{.app.metadata.name}} sync is {{.app.status.sync.status}}.</span>
      <span class="no">Application details: {{.context.argocdUrl}}/applications/{{.app.metadata.name}}.</span>
</code></pre></div>

<h3 id="trigger-definition">Trigger Definition<a class="headerlink" href="#trigger-definition" title="Permanent link">&para;</a></h3>
<p>Trigger fields has changed. The v1.0 trigger might include multiple conditions and multiple templates in each condition.</p>
<p><strong>Why was it changed?</strong></p>
<p>Multiple conditions allows to create condition <a href="../../triggers/#conditions-bundles">bundles</a> that improves user experience.</p>
<p><strong>Before</strong></p>
<div class="codehilite"><pre><span></span><code><span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">on-sync-status-unknown</span>
<span class="nt">condition</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">app.status.sync.status == &#39;Unknown&#39;</span>
<span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">app-sync-status</span>
<span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>

<p><strong>After</strong></p>
<div class="codehilite"><pre><span></span><code><span class="p p-Indicator">-</span> <span class="nt">when</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">app.status.sync.status == &#39;Unknown&#39;</span>
  <span class="nt">send</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">my-custom-template</span><span class="p p-Indicator">]</span>
</code></pre></div>

<h3 id="recipientsubscription-annotation">Recipient/Subscription Annotation<a class="headerlink" href="#recipientsubscription-annotation" title="Permanent link">&para;</a></h3>
<p>The <code>&lt;trigger-name&gt;.recipients.argocd-notifications.argoproj.io: &lt;service&gt;:&lt;recipient&gt;</code> annotation has been replaced
with <code>notifications.argoproj.io/subscribe.&lt;trigger&gt;.&lt;service&gt;: &lt;recipient&gt;</code> annotation.</p>
<p><strong>Why was it changed?</strong></p>
<p>The goal is to generalize Argo CD Notifications settings and reuse the same format in other Argo projects. So we've reworked the annotation
and removed <code>argocd-notifications</code> part.</p>
<p><strong>Before</strong></p>
<p><code>on-app-synced.recipients.argocd-notifications.argoproj.io: slack:my-channel</code></p>
<p><strong>After</strong></p>
<p><code>notifications.argoproj.io/subscribe.on-app-synched.slack: my-channel</code></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../monitoring/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Monitoring
              </div>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.08c56446.min.js"></script>
      <script src="../../assets/javascripts/bundle.6ced434e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>